# УСЛОВНАЯ ОПТИМИЗАЦИЯ, ЧАСТЬ 1

## Задача оптимизации

Задача оптимизации на следующем примере:

$f(x,y) = x^3 + y^3 -3xy  \to \min\limits_{x,y}$

Это классическая задача оптимизации — нужно найти такие $x$, $y$, чтобы функция принимала минимальное значение.

Подробрное описание ниже в конспекте

## Задача условной оптимизации

К задаче классической оптимизации добавляется условие ограничения.
Например,
- Компания производит и продаёт футболки
- Для производства используются материалы и станки
- Чем больше материалов, тем больше производство, аналогично для станков, эффект от каждого тем больше, чем больше второго
- Если $x$— количество материалов, $y$ — станков, то выручка с продажи футболок: $xy$ 

Цель компании — заработать больше денег максимизировав производство: 
Однако в реальном мире ни одна компания не обладает неограниченными ресурсами, 
поэтому задача оптимизации будет ограничена некоторыми условиями, например, бюджетом.

Наприме:
- Пусть мы располагаем бюджетом 30, который тратится на материалы ($x$ по цене 2) и станки ($у$ по цене 7).
- Тогда можем составить следующее уравнение: $2x + 7y = 30$

Получаем следующую задачу оптимизации с ограничением:

$$\begin{cases}
xy   \to \max\limits_{x,y} \\
2x + 7y = 30
\end{cases}$$

Если поменять знак в первом выражении, то получим задачу минимизации (обычно так и делают, так как это проще).

## Функция Лагранжа (Лагранжиан)

Пусть имеется следующая задача оптимизации:

$$\begin{cases} 
  f(x_1, x_2,..., x_n) \to \min\limits_{x_1,x_2,…,x_n} \\ 
  f_1(x_1, x_2,..., x_n) = 0 \\
  … \\
  f_p(x_1, x_2,..., x_n) = 0  
  \end{cases}$$

Вместо работы с исходной функцией $f(x_1, x_2,..., x_n)$ можно перейти к Лагранжиану:
$L(x_1,…,x_n, \lambda_1, …, \lambda_p) = f(x_1,…,x_n) + \lambda_1 f_1(x_1,…,x_n) + … + (\lambda_p f_p(x_1,…,x_n)$

Итак, мы хотим минимизировать функцию с соблюдением условия:

$$\begin{cases}
  -xy   \to \max\limits_{x,y} \\
  2x + 7y = 30
\end{cases}$$

Данное выражение можно объединить в одну функцию:
$\hat{L} (x,y) = -xy + I_{+ \infty}(2x + 7y-30)$

где
![image](https://github.com/user-attachments/assets/72b14cfe-ad6b-4f6a-9e90-975651547528)


Теперь можно минимизировать  $\hat{L} (x,y)$

Поскольку данная функция не является дифференцируемой, будем заменять $I_{+ \infty}(z)$  на линейную аппроксимацию:
$\hat{L} (x,y) = -xy + \lambda (2x + 7y-30)$

Дальнейший процесс поиска решений такой же, как и в безусловной оптимизации:

Вычисляем градиент и приравниваем к нулю:

$\nabla x L(x_1,…,x_n, \lambda_1, …, \lambda_p) = 0$

$\nabla \lambda L(x_1,…,x_n, \lambda_1, …, \lambda_p) = 0$

Проверяем критические точки

## Интуиция функции Лагранжа

- Визуально решение задачи — пересечение области ограничений и «лучшей» линии уровня функции
- Если сдвинуться сильнее — не выполнятся ограничения
- Если остановиться на другой линии уровня
внутри — не дойдём до минимального значения

- Если $x^\ast$, $\lambda^\ast$ - решения задачи, то $\nabla_x L(x^\ast,\lambda^\ast) = 0$

- С другой стороны:

$\nabla_x L(x^\ast , \lambda^\ast) = \nabla_x f_0 (x^\ast)  + \lambda^\ast \nabla_x f_1 (x\ast) = 0$

$\lambda^\ast$ — число, то есть градиент $f_0$ и $f_1$ сонаправлены

## Общий алгоритм оптимизации функции:

- Выписываем функцию Лагранжа
- Вычисляем градиент по всем переменным
- Приравниваем градиент нулю
- Решаем систему уравнений и находим критические точки
- Проверяем критические точки
